<!DOCTYPE HTML>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="renderer" content="webkit|ie-comp|ie-stand">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5shiv.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
		<script type="text/javascript">
			var token = "token."+sessionStorage.getItem("token");
			if(token=="token.null"){
				alert('请登录');
				location.href="login.html";
			}
		</script>
		<link rel="stylesheet" type="text/css" href="../static/h-ui/css/H-ui.min.css" />
		<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/H-ui.admin.css" />
		<link rel="stylesheet" type="text/css" href="../static/lib/Hui-iconfont/1.0.8/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/skin/default/skin.css" id="skin" />
		<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/style.css" />
		<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/common.css" />
		<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/pagestyle.css" />
		<script type="text/javascript" src="../static/lib/public.js"></script>

		<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
		<title>客户经理统计报表</title>
	</head>

	<body>
		<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 运维报表管理<span class="c-gray en">&gt;</span> 客户经理统计报表
			<a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新"><i class="Hui-iconfont">&#xe68f;</i></a>
		</nav>
		<div class="page-container">
			<div class="text-c"> 日期范围：
				<input type="text" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'datemax\')||\'%y-%M-%d\'}' })" id="datemin" class="input-text Wdate" style="width:120px;"> -

				<input type="text" onfocus="WdatePicker({ minDate:'#F{$dp.$D(\'datemin\')}',maxDate:'%y-%M-%d' })" id="datemax" class="input-text Wdate" style="width:120px;">

				<div class="cityChoose ">
					<label>请选择省份:
					<select name="" class="select">
						<option value="北京">北京</option>
						<option value="上海">上海</option>
						<option value="南京">南京</option>
						<option value="江苏">江苏</option>
					</select>
				</label>

				</div>
				<button type="submit" id="serch" class="btn btn-success radius" id="" name=""><i class="Hui-iconfont">&#xe665;</i>查询</button>
			</div>
			<div class="numChoose">
				<label>显示数量:
					<select name="" class="num_select">
						<option value="10">10</option>
						<option value="20">20</option>
						<option value="30">30</option>
						<option value="40">40</option>
					</select>
				</label>

			</div>
			<div class="mt-20">
				<table id="dataList" class=" table table-border table-bordered table-hover table-bg table-sort">
					<thead>
						<tr class="text-c">
							<th width="25">省份</th>
							<th width="25">用户名称</th>
							<th width="25">用户账号</th>
							<th width="25">使用次数</th>
						</tr>
					</thead>
					<tbody>
						<th colspan="4" class="text-c no_message">暂无数据</th>
					</tbody>
				</table>
			</div>
			<div class="page_btn hide">
				<a href="javascript:void(0);" class="next_btn">下一页</a>
				<a href="javascript:void(0);" class="prev_btn">上一页</a>
			</div>
		</div>
		<!--_footer 作为公共模版分离出去-->
		<script type="text/javascript" src="../static/lib/jquery/1.9.1/jquery.min.js"></script>
		<script type="text/javascript" src="../static/lib/layer/2.4/layer.js"></script>
		<script type="text/javascript" src="../static/h-ui/js/H-ui.min.js"></script>
		<script type="text/javascript" src="../static/h-ui.admin/js/H-ui.admin.js"></script>
		<!--/_footer 作为公共模版分离出去-->

		<!--请在下方写此页面业务相关的脚本-->
		<script type="text/javascript" src="../static/lib/My97DatePicker/4.8/WdatePicker.js"></script>
		<script type="text/javascript" src="../static/lib/datatables/1.10.0/jquery.dataTables.min.js"></script>
		<script type="text/javascript" src="../static/lib/laypage/1.2/laypage.js"></script>
		<!--<script type="text/javascript" src="../static/lib/pagination.min.js"></script>-->
		<script type="text/javascript">
			$(function() {
				//获取默认显示数据
				var table = $('datalist').DataTable();

			});
			var num = 1;
			//获取数据方法
			function getData(num) {
				var data = {};
				data.loginName = 212458;
				if($('#datemin').val() != '') {
					data.startTime = $('#datemin').val();
				}

				if($('#datemax').val() != '') {
					data.endTime = $('#datemax').val();
				}
				data.placeArea = $('select').val();
				data.pageNum = $('.num_select').val();
				data.thisPage = num;

				$.ajax({
					type: "get",
					url: url_r + "/callSalesApp/operation",
					headers: {
						Authorization: token
					},
					async: true,
					data: data,
					beforeSend: function() {
						var index = layer.load();
					},
					success: function(data) {
						var index = layer.load();
						layer.close(index);
						var data = JSON.parse(data);
						if(data.SvcCont.RespInfo.Result == 0) {
							$('#dataList tbody tr').remove();
							var dataList = '';
								if(data.SvcCont.RespInfo.LoginList.LoginDetails){
									dataList = data.SvcCont.RespInfo.LoginList.LoginDetails;
								}else{
									dataList = data.SvcCont.RespInfo.LoginList;
								}
							if(dataList == undefined) {
								$('.no_message').show();
								$('.page_btn').hide()
							} else if(dataList != undefined && dataList instanceof Array == false) {
								var dataArr = [];
								dataArr.push(dataList);
								$('.page_btn').show();
								if(num <= 1) {
									$('.next_btn').addClass('dis_btn');
									$('.prev_btn').addClass('dis_btn');
								} else {
									$('.next_btn').addClass('dis_btn');
									$('.prev_btn').removeClass('dis_btn');
								}

								$.each(dataArr, function(k, v) {
									var trs = $('<tr class="text-c"><td>' + v.PlaceAreaName + '</td><td>' + v.StaffName + '</td><td>' + v.LoginCode + '</td><td>' + v.CountTime + '</td></tr>')
									$('#dataList tbody').append(trs);
								});
								$('.no_message').hide();
							} else {
								$('.page_btn').show();
								if(dataList.length < $('.num_select').val() && num <= 1) {
									$('.next_btn').addClass('dis_btn');
									$('.prev_btn').addClass('dis_btn');
								} else if(dataList.length < $('.num_select').val() && num > 1) {
									$('.next_btn').addClass('dis_btn');
									$('.prev_btn').removeClass('dis_btn');
								} else if(dataList.length == $('.num_select').val() && num == 1) {
									$('.next_btn').removeClass('dis_btn');
									$('.prev_btn').addClass('dis_btn');
								} else {
									$('.next_btn').removeClass('dis_btn');
									$('.prev_btn').removeClass('dis_btn');
								}
								$.each(dataList, function(k, v) {
									var trs = $('<tr class="text-c"><td>' + v.PlaceAreaName + '</td><td>' + v.StaffName + '</td><td>' + v.LoginCode + '</td><td>' + v.CountTime + '</td></tr>')
									$('#dataList tbody').append(trs);
								});
								$('.no_message').hide();
							}

						} else {
							layer.msg(data.SvcCont.RespInfo.Msg, {
								icon: 2,
								time: 2000
							});
						}
					},
					error: function() {
						var index = layer.load();
						layer.close(index);
						layer.msg('请求失败!', {
							icon: 2,
							time: 1000
						});
					}
				});
			}

			$('.next_btn').click(function() {
				if($(this).hasClass('dis_btn')) {

				} else {
					$('.prev_btn').removeClass('dis_btn');
					num++;
					getData(num);
				}

			})
			$('.prev_btn').click(function() {
				if($(this).hasClass('dis_btn')) {

				} else {
					$('.next_btn').removeClass('dis_btn');
					num--;
					getData(num);
				}

			})

			//选择显示条数
			$('.num_select').change(function() {
				num = 1;
				getData(num);
			})

			//查询
			$('#serch').click(function() {
				num = 1;
				getData(num);
			})

			/*管理员-添加*/
			function admin_add(title, url, w, h) {
				layer_show(title, url, w, h);
			}
			/*用户-查看*/
			function member_show(title, url, id, w, h) {
				layer_show(title, url, w, h);
			}
			/*用户-编辑*/
			function member_edit(title, url, id, w, h) {
				layer_show(title, url, w, h);
			}
			/*密码-修改*/
			function change_password(title, url, id, w, h) {
				layer_show(title, url, w, h);
			}
			/*用户-删除*/
			function member_del(obj, id) {
				layer.confirm('确认要删除吗？', function(index) {
					$.ajax({
						type: 'get',
						url: 'http://172.16.1.77:8008/user/delete',
						headers: {
							Authorization: token
						},
						data: {
							id: id
						},
						dataType: 'json',
						success: function(data) {
							location.replace(location.href);
							$(obj).parents("tr").remove();
							layer.msg('已删除!', {
								icon: 1,
								time: 1000
							});

						},
						error: function(data) {
							layer.msg('请求失败!', {
								icon: 2,
								time: 1000
							});
						}
					});
				});
			}
		</script>
	</body>

</html>