<!DOCTYPE HTML>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="renderer" content="webkit|ie-comp|ie-stand">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5shiv.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
		<script type="text/javascript">
			var token = "token."+sessionStorage.getItem("token");
			if(token=="token.null"){
				alert('请登录');
				location.href="login.html";
			}
		</script>
		<link rel="stylesheet" type="text/css" href="../static/h-ui/css/H-ui.min.css" />
		<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/H-ui.admin.css" />
		<link rel="stylesheet" type="text/css" href="../static/lib/Hui-iconfont/1.0.8/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/skin/default/skin.css" id="skin" />
		<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/style.css" />
		<script type="text/javascript" src="../static/lib/public.js"></script>
		<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
		<title>添加配置</title>
		<meta name="keywords" content="">
		<meta name="description" content="">
	</head>

	<body>
		<article class="page-container system_add">
			<div class="system_box">
				<h4 class="text-c c-gray">添加系统参数</h4>
				<div class="mb-20">
					<label for="">系统参数：
					</label>
					<input type="text" class="input-text" id="systemKey"/>
				</div>
				<div class="mb-20">
					<label for="">系统参数值：
					</label>
					<select name="" id="systemValue" class="select">
						<option value="system_running">系统正常运行中</option>
						<option value="system_maintenancing">系统正在维护中</option>
						<option value="system_stopsystem_stop">系统暂停运行</option>
					</select>
				</div>
			</div>
			<div class="peo_box hide">
				<h4 class="text-c c-gray">添加人员配置</h4>
				<div class="mb-20">
					<label for="">staffId：
					</label>
					<input type="text" id="staffId" class="input-text" />
				</div>
				<div class="mb-20">
					<label for="">用户状态：
					</label>
					<select name="" id="status" class="select">
						<option value="in_white_list">白名单中用户</option>
						<option value="out_white_list">不在白名单中用户</option>
					</select>
				</div>
			</div>
			<div class="txt-c sub_add">
				<button class="btn btn-primary radius ">确认添加</button>
			</div>
			
		</article>

		<!--_footer 作为公共模版分离出去-->
		<script type="text/javascript" src="../static/lib/jquery/1.9.1/jquery.min.js"></script>
		<script type="text/javascript" src="../static/lib/layer/2.4/layer.js"></script>
		<script type="text/javascript" src="../static/h-ui/js/H-ui.min.js"></script>
		<script type="text/javascript" src="../static/h-ui.admin/js/H-ui.admin.js"></script>
		<!--/_footer 作为公共模版分离出去-->

		<!--请在下方写此页面业务相关的脚本-->
		<script type="text/javascript" src="../static/lib/jquery.validation/1.14.0/jquery.validate.js"></script>
		<script type="text/javascript" src="../static/lib/jquery.validation/1.14.0/validate-methods.js"></script>
		<script type="text/javascript" src="../static/lib/jquery.validation/1.14.0/messages_zh.js"></script>
		<script type="text/javascript">
			
			var pageId = getQueryString("pageId");
			var pubUrl = '';
//			var sys_id = sessionStorage.getItem('sys_id');
			if(pageId==1){
				$('.system_box').show();
				$('.peo_box').hide();
			}else{
				$('.peo_box').show();
				$('.system_box').hide();
			}
			
			//确认添加
			$('.sub_add button').click(function(){
				if(pageId==1){
					var data = {};
					pubUrl = "/systemParam/addParam";
					data.systemKey = $('#systemKey').val();
					data.systemValue = $('#systemValue').val();
					add_system(data,pubUrl);
				}else{
					var data1 = {};
					pubUrl = "/systemParam/addUser";
					data1.staffId= $('#staffId').val();
					data1.status = $('#status').val();
					add_system(data1,pubUrl);
				}
			})
			function add_system(dataUrl,url){
				$.ajax({
					type:"get",
					url:url_r+pubUrl,
					async:true,
					data:dataUrl,
					headers: {
						Authorization: token
					},
					dataType:'json',
					beforeSend:function(){
						var index = layer.load();
					},
					success:function(data){
						var index = layer.load();
						layer.close(index);
						if(data.SvcCont.RespInfo.Code==000){
							layer.msg(data.SvcCont.RespInfo.Msg,{
								icon:1,
								time:1000
							});
							setTimeout(function() {
								var index = parent.layer.getFrameIndex(window.name);
								if(pageId==1){
									parent.$('.con_btn')[0].click();
									parent.layer.close(index);
								}else{
									parent.$('.pel_btn')[0].click();
									parent.layer.close(index);
								}
								
							}, 1000)
						}else{
							layer.msg(data.SvcCont.RespInfo.Msg,{
								icon:5,
								time:1000
							})
						}
					},
					error:function(){
						var index = layer.load();
						layer.close(index);
						layer.msg('请求失败!', {
							icon: 2,
							time: 1000
						});
					}
				});
			}
		</script>
		<!--/请在上方写此页面业务相关的脚本-->
	</body>

</html>